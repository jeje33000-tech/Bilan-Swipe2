async function addLayer(info) {
  try {
    const response = await fetch(info.source + '.geojson');
    if (!response.ok) throw new Error('Erreur chargement ' + info.source + '.geojson');
    const geojson = await response.json();
    info.data = geojson;
    info.count = geojson.features.length;

    info.map.addSource(info.source, {
      type: 'geojson',
      data: geojson
    });
    // couche fill
    info.map.addLayer({
      id: info.id,
      type: 'fill',
      source: info.source,
      paint: {
        'fill-color': info.color,
        'fill-opacity': 0.6
      }
    });

    // couche symbol pour labels CODE_STATION à zoom ≥ 20
    info.map.addLayer({
      id: info.id + '-label',
      type: 'symbol',
      source: info.source,
      layout: {
        'text-field': [
          'case',
          ['>=', ['zoom'], 20],     // affichage seulement à zoom >= 20
          ['get', 'CODE_STATION'], // récupère le champ CODE_STATION
          ''
        ],
        'text-size': 12,
        'text-anchor': 'center',
        'text-offset': [0, 0]
      },
      paint: {
        'text-color': '#000',
        'text-halo-color': '#fff',
        'text-halo-width': 1
      }
    });

    createLegend(); // Actualise la légende après ajout de chaque couche
  } catch (err) {
    console.error('Erreur chargement couche ' + info.source, err);
  }
}
